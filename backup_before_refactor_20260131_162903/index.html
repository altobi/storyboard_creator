<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Storyboard Creator - Professional Film Pitch Tool</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23007acc' stroke-width='1.5'%3E%3Crect x='3' y='5' width='18' height='14' rx='1.5'/%3E%3Ccircle cx='7' cy='9' r='1.5' fill='%23007acc'/%3E%3Ccircle cx='7' cy='15' r='1.5' fill='%23007acc'/%3E%3Cpath d='M11 8h6M11 12h6M11 16h6'/%3E%3C/svg%3E">
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kalam:wght@300;400;700&family=Caveat:wght@400;700&family=Permanent+Marker&family=Shadows+Into+Light&family=Dancing+Script:wght@400;700&family=Pacifico&display=swap" rel="stylesheet">
    <script src="drawing.js" defer></script>
</head>
<body>
    <div class="app-container">
        <!-- Professional Toolbar -->
        <header class="toolbar">
            <div class="toolbar-left">
                <div class="toolbar-brand">
                    <svg class="toolbar-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <rect x="3" y="5" width="18" height="14" rx="1.5"/>
                        <circle cx="7" cy="9" r="1.5" fill="currentColor"/>
                        <circle cx="7" cy="15" r="1.5" fill="currentColor"/>
                        <path d="M11 8h6M11 12h6M11 16h6"/>
                    </svg>
                </div>
                
                <div class="toolbar-group">
                    <div class="toolbar-menu">
                        <button id="fileMenuBtn" class="toolbar-btn toolbar-btn-menu" title="File Menu">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                <polyline points="14 2 14 8 20 8"/>
                                <line x1="16" y1="13" x2="8" y2="13"/>
                                <line x1="16" y1="17" x2="8" y2="17"/>
                                <polyline points="10 9 9 9 8 9"/>
                            </svg>
                            <span>File</span>
                            <svg class="menu-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"/>
                            </svg>
                        </button>
                        <div id="fileMenu" class="toolbar-menu-dropdown">
                            <!-- App Title in Menu -->
                            <div class="menu-header">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" style="width: 16px; height: 16px;">
                                    <rect x="3" y="5" width="18" height="14" rx="1.5"/>
                                    <circle cx="7" cy="9" r="1.5" fill="currentColor"/>
                                    <circle cx="7" cy="15" r="1.5" fill="currentColor"/>
                                    <path d="M11 8h6M11 12h6M11 16h6"/>
                                </svg>
                                <span>Storyboard Creator</span>
                            </div>
                            <div class="menu-divider"></div>
                            <!-- Project Section -->
                            <button id="newProject" class="menu-item" title="New Project">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 5v14M5 12h14"/>
                                </svg>
                                <span>New Project</span>
                            </button>
                            <input type="file" id="openProject" accept=".sbp" style="display: none;">
                            <button id="openProjectBtn" class="menu-item" title="Open Project">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                    <polyline points="17 8 12 3 7 8"/>
                                    <line x1="12" y1="3" x2="12" y2="15"/>
                                </svg>
                                <span>Open Project</span>
                            </button>
                            <div class="menu-divider"></div>
                            <button id="saveProject" class="menu-item" title="Save Project">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                                    <polyline points="17 21 17 13 7 13 7 21"/>
                                    <polyline points="7 3 7 8 15 8"/>
                                </svg>
                                <span>Save</span>
                            </button>
                            <button id="saveProjectAs" class="menu-item" title="Save Project As">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                    <polyline points="17 8 12 3 7 8"/>
                                    <line x1="12" y1="3" x2="12" y2="15"/>
                                </svg>
                                <span>Save As</span>
                            </button>
                            <div class="menu-divider"></div>
                            <button id="closeProject" class="menu-item" title="Close Project">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="18" y1="6" x2="6" y2="18"/>
                                    <line x1="6" y1="6" x2="18" y2="18"/>
                                </svg>
                                <span>Close Project</span>
                            </button>
                            <div class="menu-divider"></div>
                            <!-- Images Section -->
                            <input type="file" id="imageFolder" webkitdirectory directory multiple accept="image/*" style="display: none;">
                            <button id="importImagesBtn" class="menu-item" title="Import Images">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                    <circle cx="8.5" cy="8.5" r="1.5"/>
                                    <polyline points="21 15 16 10 5 21"/>
                                </svg>
                                <span>Import Images</span>
                            </button>
                            <div class="menu-divider"></div>
                            <!-- Export Section -->
                            <button id="exportPDF" class="menu-item" title="Export PDF">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                    <polyline points="14 2 14 8 20 8"/>
                                    <line x1="16" y1="13" x2="8" y2="13"/>
                                    <line x1="16" y1="17" x2="8" y2="17"/>
                                    <polyline points="10 9 9 9 8 9"/>
                                </svg>
                                <span>Export PDF</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="toolbar-center">
                <span id="projectName" class="project-name">No project open</span>
            </div>
            
            <div class="toolbar-actions">
            
            <div class="toolbar-zoom">
                <button id="zoomOut" class="toolbar-btn" title="Zoom Out">
                    <span style="display: flex; align-items: center; justify-content: center; width: 100%; height: 100%;">−</span>
                </button>
                <input type="number" id="zoomLevel" class="zoom-input" min="25" max="300" value="100" step="1" title="Zoom Level">
                <span class="zoom-percent">%</span>
                <button id="zoomIn" class="toolbar-btn" title="Zoom In">
                    <span style="display: flex; align-items: center; justify-content: center; width: 100%; height: 100%;">+</span>
                </button>
                <button id="zoomFit" class="toolbar-btn" title="Fit to Window">Fit</button>
            </div>
            
            <div class="toolbar-panels">
                <button id="togglePageSettings" class="toolbar-panel-btn active" title="Page Settings">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2"/>
                        <line x1="9" y1="3" x2="9" y2="21"/>
                    </svg>
                </button>
                <button id="toggleTextSettings" class="toolbar-panel-btn" title="Text Settings">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="4 7 4 4 20 4 20 7"/>
                        <line x1="9" y1="20" x2="15" y2="20"/>
                        <line x1="12" y1="4" x2="12" y2="20"/>
                    </svg>
                </button>
                <button id="toggleDrawingPanel" class="toolbar-panel-btn" title="Drawing Tools">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                        <polyline points="3.27 6.96 12 12.01 20.73 6.96"/>
                        <line x1="12" y1="22.08" x2="12" y2="12"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Page Settings Panel -->
        <aside id="pageSettingsPanel" class="settings-panel">
            <div class="panel-header">
                <h3>Page Settings</h3>
                <button class="panel-close" id="closePageSettings">&times;</button>
            </div>
            
            <div class="panel-content">
                <!-- Page Layout Section -->
                <div class="settings-section">
                    <h4 class="section-title">Page Layout</h4>
                    
                    <div class="setting-group">
                        <label for="pageOrientation">Orientation</label>
                        <select id="pageOrientation">
                            <option value="landscape" selected>Landscape</option>
                            <option value="portrait">Portrait</option>
                        </select>
                    </div>

                    <div class="setting-group">
                        <label for="pageSize">Page Size</label>
                        <select id="pageSize">
                            <option value="A4">A4</option>
                            <option value="A3">A3</option>
                            <option value="Letter">Letter (8.5" × 11")</option>
                            <option value="Legal">Legal (8.5" × 14")</option>
                            <option value="Tabloid">Tabloid (11" × 17")</option>
                        </select>
                    </div>

                    <div class="setting-group">
                        <label for="imagesPerPage">Images Per Page</label>
                        <div class="scale-control">
                            <input type="range" id="imagesPerPage" min="1" max="12" value="6" step="1">
                            <input type="number" id="imagesPerPageInput" min="1" max="12" value="6" step="1" class="scale-input">
                        </div>
                        <div id="layoutInfo" style="font-size: 11px; color: #999; margin-top: 5px;">
                            Layout: 2 rows × 2 columns
                        </div>
                    </div>

                    <div class="setting-group">
                        <label for="frameScale">Frame Scale (%)</label>
                        <div class="scale-control">
                            <input type="range" id="frameScale" min="10" max="100" value="100" step="1">
                            <input type="number" id="frameScaleInput" class="scale-input" min="10" max="100" value="100" step="1">
                        </div>
                    </div>

                    <div class="setting-group">
                        <label for="imageScale">Image Scale (%)</label>
                        <div class="scale-control">
                            <input type="range" id="imageScale" min="50" max="100" value="100">
                            <input type="number" id="imageScaleInput" min="50" max="100" value="100" class="scale-input">
                        </div>
                    </div>
                </div>

                <!-- Page Appearance Section -->
                <div class="settings-section">
                    <h4 class="section-title">Page Appearance</h4>
                    
                    <div class="setting-group">
                        <label for="pageBackgroundColor">Background Color</label>
                        <input type="color" id="pageBackgroundColor" value="#404040">
                    </div>

                    <div class="setting-group">
                        <label for="pageText">Global Page Text</label>
                        <textarea id="pageText" rows="3" placeholder="Text that appears on every page..."></textarea>
                    </div>
                </div>

                <!-- Page Features Section -->
                <div class="settings-section">
                    <h4 class="section-title">Page Features</h4>
                    
                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="separateScenes"> Separate scenes to different pages
                        </label>
                    </div>

                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="showBottomText" checked> Show bottom text on pages
                        </label>
                    </div>

                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="enablePageNumbers"> Enable page numbers
                        </label>
                    </div>

                <div id="pageNumberSettings" class="setting-group" style="display: none;">
                    <label for="pageNumberPosition">Page Number Position</label>
                    <select id="pageNumberPosition">
                        <option value="top-left">Top Left</option>
                        <option value="top-center">Top Center</option>
                        <option value="top-right">Top Right</option>
                        <option value="bottom-left">Bottom Left</option>
                        <option value="bottom-center" selected>Bottom Center</option>
                        <option value="bottom-right">Bottom Right</option>
                    </select>
                    <label for="pageNumberFontSize" style="margin-top: 8px;">Font Size</label>
                    <input type="number" id="pageNumberFontSize" min="8" max="48" value="12">
                    <label for="pageNumberColor" style="margin-top: 8px;">Color</label>
                    <input type="color" id="pageNumberColor" value="#000000">
                </div>

                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="enableCoverPage"> Enable cover page
                        </label>
                    </div>

                <div id="coverPageSettings" class="setting-group" style="display: none;">
                    <label for="coverPageTitle">Project Title</label>
                    <input type="text" id="coverPageTitle" placeholder="Enter project title">
                    
                    <label for="coverPageTitleFontSize">Title Font Size</label>
                    <input type="number" id="coverPageTitleFontSize" min="12" max="72" value="48">
                    
                    <label for="coverPageTitleColor">Title Color</label>
                    <input type="color" id="coverPageTitleColor" value="#000000">
                    
                    <label for="coverPageYear">Year</label>
                    <input type="text" id="coverPageYear" placeholder="2024">
                    
                    <label for="coverPageYearFontSize">Year Font Size</label>
                    <input type="number" id="coverPageYearFontSize" min="12" max="72" value="24">
                    
                    <label for="coverPageYearColor">Year Color</label>
                    <input type="color" id="coverPageYearColor" value="#666666">
                    
                    <label for="coverPageCreators">Creators</label>
                    <textarea id="coverPageCreators" rows="2" placeholder="Enter creators..."></textarea>
                    
                    <label for="coverPageCreatorsFontSize">Creators Font Size</label>
                    <input type="number" id="coverPageCreatorsFontSize" min="12" max="72" value="18">
                    
                    <label for="coverPageCreatorsColor">Creators Color</label>
                    <input type="color" id="coverPageCreatorsColor" value="#333333">
                    
                    <label for="coverPageLogo">Logo</label>
                    <input type="file" id="coverPageLogo" accept="image/*" style="display: none;">
                    <button id="coverPageLogoBtn" class="btn btn-secondary">Select Logo</button>
                    <div id="coverPageLogoPreview"></div>
                </div>

                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="enableWatermark"> Enable watermark
                        </label>
                    </div>
                </div>

                <!-- Watermark Settings (nested) -->

                <div id="watermarkSettings" class="setting-group" style="display: none;">
                    <label for="watermarkType">Watermark Type</label>
                    <select id="watermarkType">
                        <option value="text">Text</option>
                        <option value="image">Image</option>
                    </select>
                    
                    <div id="watermarkTextSettings">
                        <label for="watermarkText">Watermark Text</label>
                        <input type="text" id="watermarkText" placeholder="Enter watermark text">
                    </div>
                    
                    <div id="watermarkImageSettings" style="display: none;">
                        <label for="watermarkImage">Watermark Image</label>
                        <input type="file" id="watermarkImage" accept="image/*" style="display: none;">
                        <button id="watermarkImageBtn" class="btn btn-secondary">Select Image</button>
                        <div id="watermarkImagePreview"></div>
                    </div>
                    
                    <label for="watermarkOpacity">Opacity</label>
                    <input type="range" id="watermarkOpacity" min="0" max="100" value="30">
                    <span id="watermarkOpacityValue">30%</span>
                </div>

            </div>
        </aside>

        <!-- Text Settings Panel -->
        <aside id="textSettingsPanel" class="settings-panel">
            <div class="panel-header">
                <h3>Text Settings</h3>
                <button class="panel-close" id="closeTextSettings">&times;</button>
            </div>
            
            <div class="panel-content">
                <!-- Page Text Settings Section -->
                <div class="settings-section">
                    <h4 class="section-title">Page Text</h4>
                    
                    <div class="setting-group">
                    <label for="pageFontFamily">Font Family</label>
                    <select id="pageFontFamily">
                        <option value="'Kalam', cursive" selected>Kalam (Handwriting)</option>
                        <option value="Arial, sans-serif">Arial</option>
                        <option value="'Helvetica Neue', Helvetica, Arial, sans-serif">Helvetica Neue</option>
                        <option value="Georgia, serif">Georgia</option>
                        <option value="'Times New Roman', serif">Times New Roman</option>
                        <option value="'Courier New', monospace">Courier New</option>
                        <option value="Verdana, sans-serif">Verdana</option>
                        <option value="'Trebuchet MS', sans-serif">Trebuchet MS</option>
                        <option value="'Kalam', cursive">Kalam (Handwriting)</option>
                        <option value="'Caveat', cursive">Caveat (Handwriting)</option>
                        <option value="'Shadows Into Light', cursive">Shadows Into Light (Handwriting)</option>
                        <option value="'Dancing Script', cursive">Dancing Script (Handwriting)</option>
                        <option value="'Pacifico', cursive">Pacifico (Handwriting)</option>
                    </select>
                </div>

                <div class="setting-group">
                    <label for="pageFontSize">Font Size</label>
                    <input type="number" id="pageFontSize" min="8" max="72" value="12">
                </div>

                <div class="setting-group">
                    <label for="pageFontWeight">Font Weight</label>
                    <select id="pageFontWeight">
                        <option value="normal">Normal</option>
                        <option value="bold">Bold</option>
                        <option value="100">Thin</option>
                        <option value="300">Light</option>
                        <option value="500">Medium</option>
                        <option value="700">Bold</option>
                        <option value="900">Black</option>
                    </select>
                </div>

                <div class="setting-group">
                    <label for="pageFontStyle">Font Style</label>
                    <select id="pageFontStyle">
                        <option value="normal">Normal</option>
                        <option value="italic">Italic</option>
                        <option value="oblique">Oblique</option>
                    </select>
                </div>

                <div class="setting-group">
                    <label for="pageLineHeight">Line Height</label>
                    <input type="number" id="pageLineHeight" min="1" max="3" step="0.1" value="1.5">
                </div>

                <div class="setting-group">
                    <label for="pageTextColor">Text Color</label>
                    <div style="position: relative; display: inline-block;">
                        <input type="color" id="pageTextColor" value="#b4b4b4">
                        <button type="button" class="color-picker-close" onclick="document.getElementById('pageTextColor').blur()" title="Close color picker">×</button>
                    </div>
                </div>

                <div class="setting-group">
                    <label for="pageTextAlign">Text Alignment</label>
                    <select id="pageTextAlign">
                        <option value="left">Left</option>
                        <option value="center">Center</option>
                        <option value="right">Right</option>
                        <option value="justify">Justify</option>
                    </select>
                </div>

                </div>

                <!-- Frame Text Settings Section -->
                <div class="settings-section">
                    <h4 class="section-title">Frame Text</h4>
                    
                    <div class="setting-group">
                        <label for="frameFontFamily">Font Family</label>
                        <select id="frameFontFamily">
                        <option value="'Kalam', cursive" selected>Kalam (Handwriting)</option>
                        <option value="Arial, sans-serif">Arial</option>
                        <option value="'Helvetica Neue', Helvetica, Arial, sans-serif">Helvetica Neue</option>
                        <option value="Georgia, serif">Georgia</option>
                        <option value="'Times New Roman', serif">Times New Roman</option>
                        <option value="'Courier New', monospace">Courier New</option>
                        <option value="Verdana, sans-serif">Verdana</option>
                        <option value="'Trebuchet MS', sans-serif">Trebuchet MS</option>
                        <option value="'Kalam', cursive">Kalam (Handwriting)</option>
                        <option value="'Caveat', cursive">Caveat (Handwriting)</option>
                        <option value="'Shadows Into Light', cursive">Shadows Into Light (Handwriting)</option>
                        <option value="'Dancing Script', cursive">Dancing Script (Handwriting)</option>
                        <option value="'Pacifico', cursive">Pacifico (Handwriting)</option>
                    </select>
                </div>

                <div class="setting-group">
                    <label for="frameFontSize">Font Size</label>
                    <input type="number" id="frameFontSize" min="8" max="72" value="12">
                </div>

                <div class="setting-group">
                    <label for="frameFontWeight">Font Weight</label>
                    <select id="frameFontWeight">
                        <option value="normal">Normal</option>
                        <option value="bold">Bold</option>
                        <option value="100">Thin</option>
                        <option value="300">Light</option>
                        <option value="500">Medium</option>
                        <option value="700">Bold</option>
                        <option value="900">Black</option>
                    </select>
                </div>

                <div class="setting-group">
                    <label for="frameFontStyle">Font Style</label>
                    <select id="frameFontStyle">
                        <option value="normal">Normal</option>
                        <option value="italic">Italic</option>
                        <option value="oblique">Oblique</option>
                    </select>
                </div>

                <div class="setting-group">
                    <label for="frameTextColor">Text Color</label>
                    <div style="position: relative; display: inline-block;">
                        <input type="color" id="frameTextColor" value="#b4b4b4">
                        <button type="button" class="color-picker-close" onclick="document.getElementById('frameTextColor').blur()" title="Close color picker">×</button>
                    </div>
                </div>

                <div class="setting-group">
                    <label for="frameTextAlign">Text Alignment</label>
                    <select id="frameTextAlign">
                        <option value="left">Left</option>
                        <option value="center">Center</option>
                        <option value="right">Right</option>
                        <option value="justify">Justify</option>
                    </select>
                </div>

                </div>

                <!-- Shot Number Settings Section -->
                <div class="settings-section">
                    <h4 class="section-title">Shot Number</h4>
                    
                    <div class="setting-group">
                        <label for="shotFontFamily">Font Family</label>
                        <select id="shotFontFamily">
                        <option value="'Kalam', cursive" selected>Kalam (Handwriting)</option>
                        <option value="Arial, sans-serif">Arial</option>
                        <option value="'Helvetica Neue', Helvetica, Arial, sans-serif">Helvetica Neue</option>
                        <option value="Georgia, serif">Georgia</option>
                        <option value="'Times New Roman', serif">Times New Roman</option>
                        <option value="'Courier New', monospace">Courier New</option>
                        <option value="Verdana, sans-serif">Verdana</option>
                        <option value="'Trebuchet MS', sans-serif">Trebuchet MS</option>
                        <option value="'Kalam', cursive">Kalam (Handwriting)</option>
                        <option value="'Caveat', cursive">Caveat (Handwriting)</option>
                        <option value="'Shadows Into Light', cursive">Shadows Into Light (Handwriting)</option>
                        <option value="'Dancing Script', cursive">Dancing Script (Handwriting)</option>
                        <option value="'Pacifico', cursive">Pacifico (Handwriting)</option>
                    </select>
                </div>

                <div class="setting-group">
                    <label for="shotFontSize">Font Size</label>
                    <input type="number" id="shotFontSize" min="8" max="72" value="14">
                </div>

                <div class="setting-group">
                    <label for="shotFontWeight">Font Weight</label>
                    <select id="shotFontWeight">
                        <option value="normal">Normal</option>
                        <option value="bold" selected>Bold</option>
                        <option value="100">Thin</option>
                        <option value="300">Light</option>
                        <option value="500">Medium</option>
                        <option value="700">Bold</option>
                        <option value="900">Black</option>
                    </select>
                </div>

                <div class="setting-group">
                    <label for="shotTextColor">Text Color</label>
                    <div style="position: relative; display: inline-block;">
                        <input type="color" id="shotTextColor" value="#ebebeb">
                        <button type="button" class="color-picker-close" onclick="document.getElementById('shotTextColor').blur()" title="Close color picker">×</button>
                    </div>
                </div>

                <div class="setting-group">
                    <label for="shotCircleScale">Rectangle Scale (%)</label>
                    <div class="scale-control">
                        <input type="range" id="shotCircleScale" min="50" max="200" value="100" step="1">
                        <input type="number" id="shotCircleScaleInput" class="scale-input" min="50" max="200" value="100" step="1">
                    </div>
                </div>
            </div>
        </aside>

        <!-- Drawing Panel -->
        <aside id="drawingPanel" class="settings-panel">
            <div class="panel-header">
                <h3>Drawing Tools</h3>
                <button class="panel-close" id="closeDrawingPanel">&times;</button>
            </div>
            
            <div class="panel-content">
                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="enableDrawing"> Enable drawing
                    </label>
                </div>

                <div id="drawingControls" style="display: none;">
                    <!-- Drawing Tools Section -->
                    <div class="settings-section">
                        <h4 class="section-title">Tools</h4>
                        
                        <div class="tool-selector">
                            <button class="tool-btn active" data-tool="brush" title="Brush">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9.06 9.06L4.94 4.94a1.5 1.5 0 0 1 0-2.12l5.66-5.66a1.5 1.5 0 0 1 2.12 0l4.12 4.12a1.5 1.5 0 0 1 0 2.12l-5.66 5.66a1.5 1.5 0 0 1-2.12 0z"/>
                                    <path d="M12 12l8 8"/>
                                    <path d="M20 20l-8-8"/>
                                </svg>
                                <span>Brush</span>
                            </button>
                            <button class="tool-btn" data-tool="pen" title="Pen">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 19l7-7 3 3-7 7-3-3z"/>
                                    <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/>
                                    <path d="M2 2l7.586 7.586"/>
                                    <circle cx="11" cy="11" r="2"/>
                                </svg>
                                <span>Pen</span>
                            </button>
                            <button class="tool-btn" data-tool="eraser" title="Eraser">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 21l-6-6m2-5a7 7 0 1 1-14 0 7 7 0 0 1 14 0z"/>
                                    <path d="M3 21l6-6"/>
                                </svg>
                                <span>Eraser</span>
                            </button>
                            <button class="tool-btn" data-tool="line" title="Line">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="5" y1="12" x2="19" y2="12"/>
                                </svg>
                                <span>Line</span>
                            </button>
                            <button class="tool-btn" data-tool="arrow" title="Arrow">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="5" y1="12" x2="19" y2="12"/>
                                    <polyline points="12 5 19 12 12 19"/>
                                </svg>
                                <span>Arrow</span>
                            </button>
                            <button class="tool-btn" data-tool="rectangle" title="Rectangle">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                </svg>
                                <span>Rect</span>
                            </button>
                            <button class="tool-btn" data-tool="circle" title="Circle">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/>
                                </svg>
                                <span>Circle</span>
                            </button>
                        </div>
                        
                        <div class="setting-group" style="display: none;">
                            <select id="drawingTool">
                                <option value="brush" selected>Brush</option>
                                <option value="pen">Pen</option>
                                <option value="eraser">Eraser</option>
                                <option value="line">Line</option>
                                <option value="arrow">Arrow</option>
                                <option value="rectangle">Rectangle</option>
                                <option value="circle">Circle</option>
                            </select>
                        </div>

                        <div class="setting-group" id="fillShapeGroup" style="display: none;">
                            <label>
                                <input type="checkbox" id="fillShape"> Fill shapes
                            </label>
                        </div>
                    </div>

                    <!-- Brush Properties Section -->
                    <div class="settings-section">
                        <h4 class="section-title">Brush Properties</h4>
                        
                        <div class="setting-group">
                            <label for="brushSize">Size</label>
                            <div class="scale-control">
                                <input type="range" id="brushSize" min="1" max="50" value="5">
                                <input type="number" id="brushSizeInput" min="1" max="50" value="5" class="scale-input">
                            </div>
                        </div>

                        <div class="setting-group">
                            <label for="brushSmoothing">Smoothing</label>
                            <div class="scale-control">
                                <input type="range" id="brushSmoothing" min="0" max="100" value="50">
                                <input type="number" id="brushSmoothingInput" min="0" max="100" value="50" class="scale-input">
                            </div>
                        </div>

                        <div class="setting-group">
                            <label for="brushColor">Color</label>
                            <div style="position: relative; display: inline-block; width: 100%;">
                                <input type="color" id="brushColor" value="#000000">
                                <button type="button" class="color-picker-close" onclick="document.getElementById('brushColor').blur()" title="Close color picker">×</button>
                            </div>
                        </div>

                        <div class="setting-group" id="fillColorGroup" style="display: none;">
                            <label for="fillColor">Fill Color</label>
                            <div style="position: relative; display: inline-block; width: 100%;">
                                <input type="color" id="fillColor" value="#000000">
                                <button type="button" class="color-picker-close" onclick="document.getElementById('fillColor').blur()" title="Close color picker">×</button>
                            </div>
                        </div>
                    </div>

                    <!-- Actions Section -->
                    <div class="settings-section">
                        <h4 class="section-title">Actions</h4>
                        
                        <div class="setting-group">
                            <div class="drawing-undo-redo">
                                <button id="undoDrawing" class="btn btn-secondary btn-full" title="Undo">↶ Undo</button>
                                <button id="redoDrawing" class="btn btn-secondary btn-full" title="Redo">↷ Redo</button>
                            </div>
                        </div>

                        <div class="setting-group">
                            <button id="clearPageDrawing" class="btn btn-secondary btn-full" style="margin-bottom: 8px;">Clear Current Page</button>
                            <button id="clearDrawing" class="btn btn-secondary btn-full">Clear All Drawings</button>
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">
            <div id="storyboardContainer" class="storyboard-container">
                <div class="empty-state">
                    <p>Create a new project or open an existing one to get started.</p>
                    <p>Import images from a folder to begin creating your storyboard.</p>
                </div>
            </div>
        </main>
    </div>

    <!-- Image Settings Modal -->
    <div id="imageSettingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Image Settings</h2>
                <button class="modal-close" type="button">&times;</button>
            </div>
            <div class="modal-body">
                <div class="setting-group">
                    <label for="imageSettingsScene">Scene Number:</label>
                    <input type="text" id="imageSettingsScene" placeholder="e.g., 1, 2, 3">
                </div>
                <div class="setting-group">
                    <label for="imageSettingsShot">Shot Number:</label>
                    <input type="text" id="imageSettingsShot" placeholder="e.g., 1, 2, 3">
                </div>
                <div class="setting-group">
                    <label for="imageSettingsFrame">Frame Number:</label>
                    <input type="text" id="imageSettingsFrame" placeholder="Auto-filled from filename">
                </div>
                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="imageSettingsRenameFile"> Rename file on disk
                    </label>
                </div>
                <div class="modal-actions">
                    <button id="imageSettingsRemove" class="btn btn-secondary" style="background: #c53030; border-color: #c53030;">Remove Image</button>
                    <button id="imageSettingsSave" class="btn btn-primary">Save</button>
                    <button id="imageSettingsCancel" class="btn btn-secondary">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Add Image Modal -->
    <div id="addImageModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add Image</h2>
                <button class="modal-close" type="button">&times;</button>
            </div>
            <div class="modal-body">
                <div class="setting-group">
                    <label for="addImageFile">Select Image:</label>
                    <input type="file" id="addImageFile" accept="image/*">
                </div>
                <div class="modal-actions">
                    <button id="addImageSave" class="btn btn-primary">Add</button>
                    <button id="addImageCancel" class="btn btn-secondary">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <span id="toastMessage"></span>
    </div>

    <!-- Custom Dialog (for alert/confirm/prompt) -->
    <div id="customDialog" class="custom-dialog">
        <div class="custom-dialog-content">
            <div class="custom-dialog-header">
                <h3 id="customDialogTitle">Alert</h3>
            </div>
            <div class="custom-dialog-body">
                <p id="customDialogMessage"></p>
                <input type="text" id="customDialogInput" style="display: none;" placeholder="">
            </div>
            <div class="custom-dialog-actions">
                <button id="customDialogCancel" class="btn btn-secondary" style="display: none;">Cancel</button>
                <button id="customDialogNo" class="btn btn-secondary" style="display: none;">No</button>
                <button id="customDialogYes" class="btn btn-primary">OK</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="fileManager.js"></script>
    <script src="app.js"></script>
</body>
</html>
